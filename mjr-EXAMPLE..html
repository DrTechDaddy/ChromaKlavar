q<!DOCTYPE html>
<html>
<head>
    <style type="text/css">
        <!--
        @page { size:8.5in 11in; margin: 0cm }
        -->

    </style>
    <meta charset="utf-8"/>
    <title id="pagetitle">dtdAM</title>
    <script type="application/javascript">
        function draw() {
            var canvas = document.getElementById("canvas");
            if (canvas.getContext) {
                var ctx = canvas.getContext("2d");
                /////// // // alert("draw:");

                
                // global values are computed by the songStart() and stafStart() functions

                //MIDI (defined by MIDI standard and gleaned from MIDI file

                // MIDI SONG INFO
                //MHdr: ticks per quarter-note
                var midiTkpQN;      //pulses per quarter note from MIDI file header

                //Time Signature:  FF 58 04 nn dd cc bb Time Signature
                //  nn: numerator; midi quarter-notes or count; copy to tsigN
                //  dd: denominator, as power of 2:  2 ^ -3 = 1/8; convert to tsigD
                //  cc: midi clocks per metronome click
                //  bb: notated 32nd notes per 24 midi clocks (nominal quarter-note)
                var midiTsigNN; //numerator of time signature
                var midiTsigDD; //denominator of time signature, converted to the power of two
                                //e.g. the midi file value 3 would be represented as 8
                // cc and bb are not relevant to sheet music


                //SONG (initialized by songStart()

                // a "quantum unit" is the nominal shortest notated note in a song.
                // it is a power of two denominator, e.g. 16 for a sixteenth note.
                //   in linear time notation, it is the unit of time corresponding to noteYSpacing
                //   it related to "ticks" or "pulses" via MIDI TkpQN from the file header
                //   in linear-time Klavar, it is represented by
                //      the nominal min distance between successive stems
                //      in pixels: noteYSpacing.
                // NOTE: if a smaller unit of time occurs occasionally in a song,
                //       in linear time notation, it may be interpolated

                var songQuantumUnit; // denom of min note unit as fraction of whole note
                var songNumQuanta;     // number of note positions (Quantum) in the song
                var songNumNotes;       //
                                // some useful conversion constants, initilaized by song start
                var songTkpWN;       // ticks per whole note
                var songTkpM;        // ticks per measure
                var songTkA;        // anacrusis ticks
                var pitchTranspose;
                var shapeTranspose;

                //SCALE
                var noteTriColor; // [Hollow,Solid,Cross] white,black,gray
                var noteStemSide;
                var noteAngle;
                var noteColor;
                var noteStemDir;






                //STAFF (initialized by staffSetup()
                // a "quantum" is the time unit in ticks for a nominal "smallest" notated note.

                var noteXSpacing;   // pixels; delta X-shift of successive notes a semitone apart.
                                    // on a Klavar staff, wholetone interval the same stem-side are TWO noteXSpacing apart.
                var noteYSpacing;   // stem - to - stem pixel distance of quantum time
                                    // pixel spacing corresponding to one quantum
                var noteYHalfSpacing;    // half y-spacing for placing bars
                var noteSize;       // width and height of notehead in pixels;
                var stemSize;       // lenght of stem in pixels;

                var pageXpx;    // Leftmost note position: anchor position on page
                var pageYpx;    // uppermost note position: anchor position on page
                var colDXpx;    // column spacing in pixels: staff UL corner to UL corner


                var noteTextFont;   //style and name of note text font, e.g. chord symbols
                var noteCountFont;   // baseline of note text

                var staffX0px;   //leftmost note-center x pixel of staff seg
                var staffY0px;   //topmost stem y pixel on seg; staff lines start half y-spacing sooner
                var staffXWidth; // width of staff = bar length



                var staffYPQ;  // note-time spaces (quantum times) per quarter note
                var staffXLpx;  //leftmost end of bar; computed by staff() = LEFT MARGIN
                var staffXRpx;  //rightmost end of bar; computed by staff()
                var staffY0tk;  //starting tick number for staff segment
                var staffTkPPos; // ticks per note position
                var staffSegPos; //positions per staff segment
                var staffCountWidthPx;   //px for count info

                var NoteLmidiAxis = 41;  //F2  lowest midi note  for Axis;
                var NoteRmidiAxis = 79;  //G5  highest midi note for Axis;
                var staffNoteLmidi;     // D2 < F2 ; midi # of leftmost staff posn staffX0px
                var staffNoteRmidi;     // G#5 > G5; midi # of rightmost staff posn = 79

                // STAFF SEGMENT POSITION
                var staffAutoOn;      // true: staff positions computed by midiNote.
                                    // false: staff calls included in midiNote stream
                var staffCurCol;      //column number, 0-origin
                var staffCurPage;      //page number, 0-origin
                var staffNextCol;
                var staffNextPage;
                var staffMaxCols;   // cols per page
                var staffColLenTk;          // col len in ticks
                var staffColLenPx;        // col len in pixels



                var staffSegNextTk;     // tick for start of first/next staff seg
                var staffSegDeltaTk;    // number ticks in individual segment
                var staffCurXPx;        // current column staff x-origin in pixels
                var staffCurYPx;        // current page staff y-origin in pixel
                var staffXSpacingPx;    // col spacingin pixels , x-direction
                var staffYSpacingPx;   // page spacing in pixels, y-direction

                //STAFF STYLE
                var staffLineWidth; // [C..B] pixels
                var staffLineStyle; // [C..B] | solid; - dashed; null none.
                var staffLineColor; // [C..B] HTML color

                //BAR

                var staffMBar1Tk;       //tick for first measure bar
                var staffMBarDeltaTk;   //ticks between measure bars
                var staffMBarNextTk;    //tick for next measure bar (incr by midiNote);

                var staffLinesSolid;
                var staffLinesCross;
                var staffLinesDashed;
                var staffLinesLedger;





                //COUNT
                var countNextTk;  //first/next tick for count
                var countDeltaTk; //ticks between count legend
                var countNextI; //start/next index for count
                var countDeltaI;//incr of count index
                var countWrap; // wrap-around index


                var counts16;





////////////////////////////////////////////////////////////////////////////////////////////////////////

                function staffSetup(dpx, dpy, nsz, ssz, nL, nR, solid, cross, dashed, ledger ) {
                    //dpx: x note spacing in pixels (semitone center-center)
                    //dpy: y note spacing in pixels (stem-stem or center-center)
                    //nsz: note size: even number resulting in nsz+1 pixels wide/high triangles
                    //ssz: stem size: pixels from center line of notehead
                    //nL: midi number of leftmost note, position px0
                    //nR: midi number of rightmost note,
                    //TBD: verify canvas is large enough
                    //solid:    array of midi note numbers for solid-note staff lines
                    //cross:   array of midi note numbers for cross-note staff lines
                    //hollow:   array of midi note numbers for hollow-note staff lines
                    //ledger:   array of midi note numbers for ledger lines //TBD

                    //staff positions  38    44    50    56    62    68    74    80  ES staff
                    //                  :     |     :     |     :     |     :     |
                    //staff positions    40  44  48  52  56  60  64  68  72  76  80  Clairnote
                    //                    |   |   :   |   |   :   |   |   :   |   |
//// // alert("staffSetup(dpx "+dpx+",dpy "+dpy+",nsz "+nsz+",ssz"+ssz+",nL "+nL+",nR "+nR+",solid "+solid+",dashed "+dashed+", ledger"+ledger+")");


//// // alert("staffSetup noteTextFont "+noteTextFont+" staffXWidth "+staffXWidth);
                }//function staffSetup

                function staffDraw(x0px, y0px, y0tk, yNtk, nPos) {
                 // // // alert("staffDraw(x0px="+x0px+",y0px="+y0px+",y0tk="+y0tk+",yNtk="+yNtk+",nPos="+nPos+")");
                    //x0px: pixel of leftmost note center
                    //y0px: pixel of first note stem
                    //y0tk: tick of first note on staff at pixel py0
                    //yDtk: number of ticks in a staff seg
                    staffX0px = x0px;   //leftmost note-center x pixel;
                    staffY0px = y0px;   //topmost stem y pixel; staff lines start note space sooner
                    staffY0tk = y0tk;   //tick of top seg position
                    if (nPos === undefined) {
                        staffSegPos = (yNtk - y0tk) / staffTkPPos; // number of note positions for segment
                    }else{
                        staffSegPos = nPos;
                    }
                    staffXLpx  = staffX0px - 2 * noteXSpacing;
                    staffXRpx  = staffX0px + staffXWidth;

                    //compute starting tick for staff
                    // m n d will compute to a tick number
                    // for an anacrusis note, m <=0 and tick will be negative.
                    // if there is an anacrusis,
                    //  m-1 will be negative and  (n-1)/d < -m
                    // example 4/8 anacrusis in 6/8 time: m=0, n=3,d=8
                    //   m-1 = 0-1 = -1
                    //  n-
                    //             -5        * 72  / 8 = -216 / 8 = -27 ticks

                    //  staffY0tk = songTkA + ( songTkpM *(m-1) + (songTkpWN *(n-1))/d ) ;

                    var staffYTop = staffY0px - noteYHalfSpacing; // leader
                    var staffYBot = staffYTop +  noteYSpacing * (staffSegPos +1);
//// // alert("staffSeg staffY0tk ="+staffY0tk+" staffYTop="+staffYTop+" +staffYBot="+staffYBot) ;
                    var notePos,  index, staffX;
                    for (notePos=staffNoteLmidi; notePos<=staffNoteRmidi; notePos++) {
                        index = notePos % 12;
                        staffX = staffX0px + (notePos - staffNoteLmidi) * noteXSpacing;

                        //STAFF LINE
                        if (staffLineStyle[index] == "|") {//solid
                            ctx.lineWidth = staffLineWidth[index];
                            ctx.strokeStyle = staffLineColor[index];
                            ctx.setLineDash([]);
                            ctx.beginPath();
                            ctx.moveTo(staffX, staffYTop);
                            ctx.lineTo(staffX, staffYBot);
                            ctx.stroke();

                        } else if (staffLineStyle[index] == "-"){//dashed
                            //solid colored background
                            ctx.setLineDash([]);    //solid
                            ctx.lineWidth = staffLineWidth[index];
                            ctx.strokeStyle = staffLineColor[index];
                            ctx.beginPath();
                            ctx.moveTo(staffX, staffYTop);
                            ctx.lineTo(staffX, staffYBot);
                            ctx.stroke();
                            //dashed black line
                            ctx.setLineDash([noteXSpacing, 3*noteXSpacing]); //dashed
                            ctx.strokeStyle = "black";
                            ctx.beginPath();
                            ctx.moveTo(staffX, staffYTop);
                            ctx.lineTo(staffX, staffYBot);
                            ctx.stroke();
                        }
                        //LEDGER LINES TBD

                    }//for notePos
                }//function staffSeg

                function tri(x,y,size,stem,angle,chroma,symbol){
                    {
                        // // alert("tri(x="+x+",y="+y+",size="+size+",stem="+stem+",angle="+angle+",chroma="+chroma+",symbol="+symbol+")");
                    }


                    // x horizonal loc of left side of note
                    // y vertial loc of stem line
                    // size half-height and width of triangle
                    //   + for up side of stem; - for down side
                    // stem length + right - left
                    // angle: 0 3 6 9 clock position UP triangle points
                    //
                    // -7              *
                    //
                    // -6            *   *
                    //
                    // -5          *       *
                    //
                    // -4        *           *
                    //
                    // -3      *               *
                    //
                    // -2    *                   *
                    //
                    // -1  *   *   *   *   *   *   *
                    //
                    //    -3  -2  -1   0   1   2   3
                    //
                    //  1  *
                    //         *
                    //  2  *       *
                    //                 *
                    //  3  *               *
                    //                         *
                    //  4  *                       *
                    //                         *
                    //  5  *               *
                    //                 *
                    //  6  *       *
                    //         *
                    //  7  *
                    //
                    //    -3  -2  -1   0   1   2   3
                    // pattern: fill pattern of triangle: solid, cross, hollow
                    // color: fill color of triangle
                    // Filled triangle
                    // initially, fit triangle in 7x7 box.

                    //starting position:
                    //  x=0 note center; right positive
                    //  y=0 stem line;   down  positvie
                    //  size of note; must be even; sign gives side of stem: + up, - down

                    var h= size>0?size:-size;       // abs value
                    var h2 = Math.floor(h/2);      //half
                    var h8 = Math.ceil(h/8);       //eighth
                        h  = 2*h2;                  //make it even
                    var y0= size>0?y-h-1:y+1;       // top of notehead

                    var xs=x;        //stem start default
                    var xe=xs+stem;  // stem end default
                    //positions
                    var xl=x-h2;    //left
                    var xc=x;       //center
                    var xcp=xc+1;
                    var xcm=xc-1;
                    var xr=x+h2;    //right
                    var yt=y0;      //top
                    var ym=y0+h2;   //middel
                    var yb=y0+h;    //bottom

                    var fil = chroma==""?"gray":chroma; //default color

                    ctx.setLineDash([]);    //solid
                    ctx.lineWidth=1;
                    ctx.strokeStyle="Black";


                    if (symbol =="%"){ // rest symbol
                        ctx.beginPath();
                        ctx.moveTo(xl,yt);
                        ctx.lineTo(xl,yt+h8);
                        ctx.lineTo(xl+h8,yt+h8);
                        ctx.lineTo(xl+h8,yt);
                        ctx.lineTo(xl,yt);

                        ctx.moveTo(xr,yt);
                        ctx.lineTo(xl,yb-h8);
                        ctx.lineTo(xl,yb);
                        ctx.lineTo(xr,yt+h8);
                        ctx.lineTo(xr,yt);


                        ctx.moveTo(xr,yb);
                        ctx.lineTo(xr,yb-h8);
                        ctx.lineTo(xr-h8,yb-h8);
                        ctx.lineTo(xr-h8,yb);
                        ctx.lineTo(xr,yb);

                        



                        ctx.fillStyle=fil;
                        ctx.fill();
                        /*
                        xs = xc;      //stem from center
                        xe = xs+stem;
                        ctx.moveTo(xs, y);           // stem
                        ctx.lineTo(xe, y);    // stem
                        */
                        ctx.moveTo(x,y);            //close
                        ctx.stroke();
                    }
                    else if (symbol =="="){ // hold symbol
                        ctx.beginPath();
                        ctx.moveTo(xc,yt);
                        ctx.lineTo(xc-h8,yt+h8);
                        ctx.lineTo(xc,yt+h8+h8);
                        ctx.lineTo(xc+h8,yt+h8);
                        ctx.lineTo(xc,yt);

                        ctx.moveTo(xc,ym-h8);
                        ctx.lineTo(xc-h8,ym);
                        ctx.lineTo(xc,ym+h8);
                        ctx.lineTo(xc+h8,ym);
                        ctx.lineTo(xc,ym-h8);

                        ctx.moveTo(xc,yb);
                        ctx.lineTo(xc-h8,yb-h8);
                        ctx.lineTo(xc,yb-h8-h8);
                        ctx.lineTo(xc+h8,yb-h8);
                        ctx.lineTo(xc,yb);


                        ctx.fillStyle=fil;
                        ctx.fill();
                        /*
                         xs = xc;      //stem from center
                         xe = xs+stem;
                         ctx.moveTo(xs, y);           // stem
                         ctx.lineTo(xe, y);    // stem
                         */
                        ctx.moveTo(x,y);            //close
                        ctx.stroke();
                    }

                    else if (angle==0) {//point up

                        ctx.beginPath();
                        ctx.moveTo(xc,yt);
                        ctx.lineTo(xl,yb);
                        ctx.lineTo(xr,yb);
                        ctx.lineTo(xc,yt);
                        ctx.fillStyle=fil;
                        ctx.fill();

                        xs = xc;      //stem from center
                        xe = xs+stem;
                        ctx.moveTo(xs, y);           // stem
                        ctx.lineTo(xe, y);    // stem
                        ctx.moveTo(x,y);            //close
                        ctx.stroke();

                    }else if (angle==3) {   //point right
                        ctx.beginPath();
                        ctx.moveTo(xr,ym);
                        ctx.lineTo(xl,yt);
                        ctx.lineTo(xl,yb);
                        ctx.lineTo(xr,ym);
                        ctx.fillStyle=fil;
                        ctx.fill();

                        xs = xl;      //stem from bottom left
                        xe = stem<0?xs+stem:xs+stem+h;
                        ctx.moveTo(xs, y);
                        ctx.lineTo(xe, y);
                        ctx.moveTo(x,y);        //close
                        ctx.stroke();

                    } else if (angle==6) {//point down
                            ctx.beginPath();
                            ctx.moveTo(xc,yb);
                            ctx.lineTo(xl,yt);
                            ctx.lineTo(xr,yt);
                            ctx.lineTo(xc,yb);
                            ctx.fillStyle=fil;
                            ctx.fill();

                            xs = xc;      //stem from center
                            xe = xs+stem;
                            ctx.moveTo(xs, y);
                            ctx.lineTo(xe, y);
                            ctx.moveTo(x,y);    //close
                            ctx.stroke();

                    } else if (angle==9) {    // point left
                            ctx.beginPath();
                            ctx.moveTo(xl,ym);
                            ctx.lineTo(xr,yt);
                            ctx.lineTo(xr,yb);
                            ctx.lineTo(xl,ym);
                            ctx.fillStyle=fil;
                            ctx.fill();

                            xs = xr;      //stem from bottom right
                            xe = stem<0?xs+stem-h:xs+stem;
                            ctx.moveTo(xs, y);
                            ctx.lineTo(xe, y);
                            ctx.moveTo(x,y);        //close
                            ctx.stroke();

                    }
                }//tri



                function barDraw(xl, xr, y, barType){
                    // tk:
                    if (barType === undefined || barType ==  "|") {
                        ctx.setLineDash([]);    //solid
                    } else if (barType == "-") {
                        var dashSize= noteXSpacing;
                        ctx.setLineDash([dashSize,dashSize]);    //dashed
                    }
                    ctx.lineWidth=2;
                    ctx.beginPath();

                    ctx.moveTo(xl, y);
                    ctx.lineTo(xr, y);
                    ctx.moveTo(xl, y); //close

                    ctx.stroke();

                }

                function barSetup(aTk, sTk, dTk, bTk){
                    return;
                }

                function songTk(m,n,d){
                    // m: measure number
                    // n: numerator of count within measure
                    // d: denominator of count within measure
                    // see staffSeg for more details

                    var tk = songTkA + ( songTkpM *(m-1) + (songTkpWN *(n-1))/d );   //tick
//// // alert("songTk: tk ="+tk+" songTkA="+songTkA+" + ( songTkpM="+songTkpM+" *(m-1) + (songTkpWN="+songTkpWN+" *(n-1))/d )");   //tick

                    return tk;
                }

                function bar(tk, barType){
                    // draw a bar before  note position m,n,d at current staffXWidth
                    //   uses globals set by staffSetup, staffSeg functions

                    // type: | full, - dash, = double, # thick


                    var yPx = staffY0px+  ( (tk - staffY0tk) * noteYSpacing ) / staffTkPPos
                            - noteYHalfSpacing;  // back up between notes
//// // alert("bar: yPx="+yPx+" = (tk:"+tk+"+staffY0tk:"+staffY0tk+") * noteYSpacing:"+noteYSpacing+" / staffTkPPos:"+staffTkPPos+" - noteYHalfSpacing:"+noteYHalfSpacing) ;

                    barDraw(staffXLpx, staffXRpx, yPx, barType);  // draw bar
                }

                function noteText(tk, xPx, cmt){

                    var y = staffY0px + ( (tk - staffY0tk) * noteYSpacing ) / staffTkPPos ;
                    ctx.textBaseline="middle";
                    ctx.font= noteTextFont;
                    ctx.fillStyle="black";
                    ctx.fillText(cmt,xPx,y);
                }

                function noteCount(tk, cnt){

                    var yPx = staffY0px + ( (tk - staffY0tk) * noteYSpacing ) / staffTkPPos ;
                    var xPx = staffXLpx - staffCountWidthPx;
                    if(tk<4000)
                    //     // // alert("noteCount: "+
                    //        "cnt="+cnt+", yPx="+yPx+"staffY0px="+staffY0px+" + ( (tk="+tk+" - staffY0tk="+staffY0tk+
                    //        ") * noteYSpacing="+noteYSpacing+" ) / staffTkPPos="+staffTkPPos+
                    //        ",  xPx="+xPx+"staffXLpx="+staffXLpx+" - staffCountWidthPx="+staffCountWidthPx);
                    ctx.textBaseline="middle";
                    ctx.font= noteCountFont;
                    ctx.fillStyle="black";
                    ctx.fillText(cnt,xPx,yPx);
                }

                // CREATE STAFF SEGMENT

                function staffSeg(x0px, y0px, yStartTk, yStopTk,nPos){
                //draw staff seg  with bars and counts for tick range
                     // // // alert("call:staffDraw(pageXpx="+pageXpx+" + staffCurCol="+staffCurCol+" * colDXpx="+colDXpx+", pageYpx="+pageYpx+", staffSegNextTk="+staffSegNextTk+", staffTkPPos="+staffTkPPos+", staffSegPos="+staffSegPos+")");
                    staffDraw(x0px, y0px, yStartTk, yStopTk, nPos);

                    // bars
                    while (staffMBarNextTk < yStopTk) {
                        //if(tk<4000)// // // alert("midiNote bar: tk="+tk+",staffMBarNextTk="+staffMBarNextTk);
                        bar(staffMBarNextTk, "|");
                        staffMBarNextTk += staffMBarDeltaTk;
                    }

                    // counts
                    while (countNextTk < yStopTk) {

                        // if(tk<4000)
                        // // // alert("midiNote count: (tk="+tk+">= countNextTk="+countNextTk+",&& < tk < staffSegNextTk"+tk < staffSegNextTk+"counts16[countNextI="+countNextI+"])="+counts16[countNextI]);

                        noteCount(countNextTk, counts16[countNextI % countWrap]);
                        countNextTk += countDeltaTk;
                        countNextI += countDeltaI;
                    }
                }
                function staffAuto(tk) {
                    //TBD -- as of 12/23, draws only 1 seg.
                    //  draw full 1 page staff w. bars and counts for new tick range
                    var staffTk;

                     {
    // // alert("staffAuto(tk="+tk+"),staffSegNextTk="+staffSegNextTk+",staffNextPage="+staffNextPage+",staffNextCol="+staffNextCol);

                        if(tk >= staffSegNextTk) {

                            staffCurPage = staffNextPage;
                            staffCurCol = staffNextCol;
                            staffNextCol += 1;
                            if (staffNextCol == staffMaxCols) {
                                staffNextPage += 1;
                                staffNextCol = 0;
                            }
                            var staffStartTk = staffSegNextTk;
                            // // alert("call:staffSeg(pageXpx=" + pageXpx + ",staffCurCol:" + staffCurCol + " * colDXpx:" + colDXpx + ", pageYpx=" + pageYpx + ",staffStartTk=" + staffStartTk, +", staffSegNextTk=" + staffSegNextTk + ", = staffTkPPos:" + staffTkPPos + " * staffSegPos:" + staffSegPos + ")");
                            staffSegNextTk += staffTkPPos * staffSegPos;
                            staffSeg(pageXpx + staffCurCol * colDXpx, pageYpx, staffStartTk, staffSegNextTk);
                        }
                    }
                    /*
                     // bar if needed
                     if (tk >= staffMBarNextTk && isNoteOn) {
                     if (tk < 4000)// // // alert("midiNote bar: tk="+tk+",staffMBarNextTk="+staffMBarNextTk);
                     bar(staffMBarNextTk, "|");
                     staffMBarNextTk += staffMBarDeltaTk;
                     }
                     */
                }// autoStaff

                // PLACE NOTE ON STAFF

                function midiNote(tk,st,ch,note,vel,sym) { //CONVERT MIDI COMMAND TO tri call.

                    // MIDI NOTE INFO
                    //tk:    absolute tick within song (signed; neg for anacrusis)
                    //st:   status (action): 9=noteOn; 8=noteOff
                    //ch:    channel: midi (channel-1): ch 1-16 as 0x0..0xF
                    //note:    midi note number 60 = 0x3C = middle C
                    //vel:    velocity; s=9,v=0 is noteOff.
                    //sym:   special symbol to replace notehead

                    //extended operands
                    //m:    measure
                    //n:    count numerator
                    //d:    count denominator

                    //  GLOBALS STAFF INFO
                    //noteX0    x pixel of first staff position
                    //noteY0    y pixel of first staff position
                    //noteXSpacing: half-center-to-center of noteheads across
                    //noteYSpacing: stem to stem vertical distance
                    //staffY0tk:    starting tick for the current staff segment
                    //note0     midi note number of first staff position
                    //noteSize: half-width of notehead in pixels
                    //noteAngle: array of notehead angles 0 3 6 9 per midi mod 12
                    //noteColor: array of notehead colors R Y B per midi mod 12
                    //noteStem: array of stem sizes + = right; - = left per (channel-1)
                    //tp4:  ticks per quarter note
                    //tpq:  ticks per quantum
                    //tp4, tpq, and noteYSpacing are used to convert m,q,t to vertical pixel spacing


                    // convert ticks to y pixel
                    //      tpn = ticks per note    = tpm / npm
                    //                              = (tpq * qpm) / (nn * qq)
                    //                              = tpq * (nn * 4 / dd) / (nn * qq)
                    //                              = tpq * (nn * 4 ) / (dd * nn * qq)
                    //                              = (tpq * 4) / (dd * qq)
                    // tpq:     ticks per midi quarternote
                    // bb:      32nds per midi quarternote
                    //
                    //m:    measure: 1-origin; 0 for anancrusis measure
                    //n:    numerator fraction within measure of note-on count: 1-origin
                    //q:    denominator of fractton within measure (includes swing)
                    //nk:   note count: ordinal number of stem position within song

                    var x, y, size, stem, angle, chroma;
                    var noteMod = (note) % 12;     //midi note mod
                    var pitchMod = (note + pitchTranspose) % 12;
                    var shapeMod = (note + shapeTranspose) % 12;

                    var isNoteOn = (st == "Note_on_c" && vel > 0);
                    var isNoteOff = (st == "Note_off_c" || (st == "Note_on_c" && vel == 0));
                    {
      // // alert("midiNote(tk=" + tk + ",st=" + st + ",ch=" + ch + ",note=" + note + ",vel=" + vel + ",sym=" + sym + ")");
                    }
                    if (isNoteOn) {// note on
// // // alert("staffAutoOn="+staffAutoOn+"&& staffSegNextTk="+staffSegNextTk+"<= tk="+tk+" && isNoteOn="+isNoteOn+") ");
                        if (staffAutoOn) { ///&& staffSegNextTk <= tk && isNoteOn) {
                            staffAuto(tk);
                        } else {//staff calls embedded in midiNote stream
                            //TBA
                        }
                        //  note




                        y = staffY0px + ( (tk - staffY0tk) * noteYSpacing ) / staffTkPPos;
                        x = staffX0px + noteXSpacing * (note + pitchTranspose - staffNoteLmidi );
    // // alert("tri:: y:" + y + " = staffY0px:" + staffY0px + " + ( (tk:" + tk + " - staffY0tk:" + staffY0tk + ") * noteYSpacing:" + noteYSpacing + " ) / staffTkPPos:" + staffTkPPos);
    // // alert("tri:: x:" + x + " = staffX0px:" + staffX0px + " + noteXSpacing:" + noteXSpacing + " * (note:" + note + " + pitchTranspose:" + pitchTranspose + " - staffNoteLmidi:" + staffNoteLmidi);
                        size = noteStemSide[pitchMod] * noteSize;
                        stem = noteStemDir[ch] * stemSize;
                        angle = noteAngle[shapeMod];
                        chroma = noteColor[shapeMod];

                        tri(x, y, size, stem, angle, chroma);

                    } else if(isNoteOff) {// note off--ignore
                    } else {// ignore
                    }


                } //function midiNote

                function Note_hold_c(null1,trk,tk,st,ch,note,vel,null2){
                //// // alert("Note_hold_c(null1="+null1+",trk="+trk+",tk"+tk+",st"+st+",ch"+ch+",note"+note+",vel"+vel+",null1="+null2+")");

                    midiNote(tk, st, ch, note, vel, "=");
                } //function Note_hold_c

                function Note_rest_c(null1,trk,tk,st,ch,note,vel,null2){
                //// // alert("Note_rest_c(null1="+null1+",trk="+trk+",tk"+tk+",st"+st+",ch"+ch+",note"+note+",vel"+vel+",null1="+null2+")");

                    midiNote(tk, st, ch, note, vel,"%");
                }//function Note_rest_c



                function Note_on_c(null1,trk,tk,st,ch,note,vel,null2){
                    // extract note info from Note_on_c file
                     /////// // // alert("Note_on_c(null1="+null1+",trk="+trk+",tk"+tk+",st"+st+",ch"+ch+",note"+note+",vel"+vel+",null1="+null2+")");

                    midiNote(tk, st, ch, note, vel);
                }

                function midiCSV(pad1,trk,tk,st,ch,note,vel,sym){
                    // extract note info from Note_on_c file
                    /////// // // alert("Note_on_c(null1="+null1+",trk="+trk+",tk"+tk+",st"+st+",ch"+ch+",note"+note+",vel"+vel+",null1="+null2+")");

                    midiNote(tk, st, ch, note, vel, sym);
                }//function midiCSV
                function songStart(tp4, tsN, tsD ){ //,qD, aQ,  stL, stR) {
                    //tp4: ticks per quarter note, from MIDI header
                    //tsN: numerator of time signature
                    //tsD: denominator of time signature

                    //initialize GLOBALS for song from MIDI data

                    //compute song position m n p corresponding to tick number
                    //use whenever staff position, quantum, or time signature changes



                    //qD: note quantum: 1/qD = fraction of wholenote of typical shortest note
                    //      eg q0=8 => a an eighth note consumes one noteYspacing.
                    //     used for linear time score

                    //aQ:   anacrusis quanta; number of qD units before the first bar

                    // EXAMPLE:

                    //qTot: number of note positions  (Quantum) in song
                    //stL: midi number of leftmost note of STAFF
                    //stR: midi number of rightmost note of STAFF


                    //// // alert("songStart midiTkpQN="+ midiTkpQN+" midiTsigNN="+ midiTsigNN+" midiTsigDD="+ midiTsigDD);
                    /*
                    songTkpWN  =  4 * midiTkpQN;                  // ticks per whole note
                    songTkpM  = songTkpWN * midiTsigNN / midiTsigDD;  // ticks per measure
                    songQuantumUnit = qD;   //note spaces per measure
                    songTkpQuantum = songTkpWN / songQuantumUnit; //ticks pre quantum
                    songTkA=songTkpQuantum * aQ;
                    staffNoteLmidi =stL;
                    staffNoteRmidi =stR;
                    */
                    return;
                }

                function satb(m,n,d, b,t,a,s, c){
                    // GLOBALS
                    // mm:    total measures in song
                    // tsigN:    counts per measure; num of time sig
                    // tsigD:    unit of count; denom of time sig
                    //      qpm = quarter-notes per measure = tsigN * (4 / tsigD)
                    //      tpm = ticks per measure = tpq * qpm
                    //                              = 4 * tpq * tsigN / tsigD
                    // tk:  start tick = ((m-1) * m + (n-1)/d) * tpm
                    //

                    //function midiNote(m,n,d, st,c,n,v)
                    // m: measure number, 1-origin
                    // n: numerator of count of note
                    // d: denominator of count of note in notated units
                    //    convert d to quarter notes based on notated 32nd per quarter note
                    // EXAMPLE: in 6/8 time:  tsigNN=6; tsigDD=8;
                    //   n/d = 4/8 = the 4th of 6 eight notes counts in the measure
                    // EXAMPLE: in 4/4 time:  tsigNN=4; tsigDD=4;
                    //   n/d = 6/12 the 6th of 12 triplet-eighth counts in the measure.
                    // NOTE: n is a number of d units, not necessarily a fraction of measure,
                    //  as a measure may contain more or less than a whole note time.
                    // it relates to "notated units per quarter note" and "ticks per quarter note"

                    // b, t, a, s: midi numbers of notes for 4 voices
                    // c: comment text, e.g. chord name, fingering, lyrics
                    // CONVERT SONG POSITION m.q,k to tick
                    // Quantum / quarter = Quantum/count * units/quarter = qq*(dd/4)
                    // ticks/Quantum = (ticks/quarter) / (Quantum/quarter)

                    //c: comment text centerd after RH stem

                    var tk = songTkA + songTkpM * (m-1) + songTkpWN *(n-1)/d  ;

                    midiNote(tk,9,3,b,64);
                    midiNote(tk,9,2,t,64);
                    midiNote(tk,9,1,a,64);
                    midiNote(tk,9,0,s,64);
                    if(c !== undefined){// comment present
                        noteText(tk,staffXRpx,c);
                    }
                }//function satb


////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////


                /**
                 * Created by josephaustin on 8/26/15.
                 */


                //SCALE DATA


                var noteAngleC          = [0, 3, 6, 9, 0, 3, 6, 9, 0, 3, 6, 9];//per C..B = midi mod 12
                var noteStemDirBT_AS    = [+1, +1, -1, -1, 0, 0, 0, 0, 0, -1, 0, 0, +1, 0, -1, 0];  //per channel 0..15
                var noteStemDirUMH    = [0, 0, +1, +1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ];  //per channel 0..15
                var noteStemDirRhLh    = [0, 0, +1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ];  //per channel 0..15


                //var axisBlue="DodgerBlue";
                // var axisBlue="CornflowerBlue";
                //var axisBlue="LightSkyBlue";
                var axisBlue="DeepSkyBlue";
                //var axisWhite="AntiqueWhite";
                var axisWhite="NavajoWhite";
                //var axisWhite="Gold";
                //var axisWhite="Ivory";
                //var axisBlue="LightBlue";

                var noteColorAxis = [
                    //    "Gray","Ivory","LightSkyBlue",
                    "Black",axisWhite,axisBlue,
                    "Black",axisWhite,axisBlue,
                    "Black",axisWhite,axisBlue,
                    "Black",axisWhite,axisBlue
                ];  //per C..B = midi mod 12

                var noteColorSoriano = [
                    axisWhite,axisBlue,"Navy",
                    axisWhite,axisBlue,"Navy",
                    axisWhite,axisBlue,"Navy",
                    axisWhite,axisBlue,"Navy"
                   ];  //per C..B = midi mod 12

                var noteColorPertchik = [
                    "Red","White","Black",
                    "Red","White","Black",
                    "Red","White","Black",
                    "Red","White","Black"
                ];  //per C..B = midi mod 12

                var noteColorPertchikDTD = [ //my piano
                    "Red","Gold","Blue",
                    "Red","Gold","Blue",
                    "Red","Gold","Blue",
                    "Red","Gold","Blue"
                ];  //per C..B = midi mod 12

                var noteColorYRB = [
                    "Gold","Red","Blue",
                    "Gold","Red","Blue",
                    "Gold","Red","Blue",
                    "Gold","Red","Blue"
                ];  //per C..B = midi mod 12



            //STAFF DATA CONSTANTS

                //Clairnote - Dtd version
                var staffLineStyleClarinote   = ["-",,,, "|",,,, "|",,,]; // C E Ab
                var staffLineWidthClairnote = [2,,,, 2,,,, 2,,,]; //double-width
                var staffLineColorClairnoteBW = ["White",,,,"Black",,,,"Black",,,];


                // ExpressStave - Dtd version
                var staffLineStyleES          = [,,"|", ,,, ,,"-", ,,];  // D Ab



                // Axis49




                //DTD
                var staffLineColorDTD = ["Gold",,,,"Blue",,,,"Red",,,];




                //Transitional
                var staffLineColorTransBW = [,,"White",,,,"Black",,,,"Black",];
                var staffLineColorTrans = [,,"Gold",,,,"Blue",,,,"Red",];
                var staffLineStyleTrans   = [,,"-",,,, "|",,,, "|",]; // C E Ab
                var staffLineWidthTrans = [,,2,,,, 2,,,, 2,]; //double-width




                //Traditional




                //OGP
                var noteColorOGP = [
                    "Orange","Green","Indigo",
                    "Orange","Green","Indigo",
                    "Orange","Green","Indigo",
                ];  //per C..B = midi mod 12
                var staffLineColorOGP = ["Orange",,,,"Indigo",,,,"Green",,,];





                var noteColorYBR = [  //aka NoteColorDTD
                    "Gold","Blue","Red",
                    "Gold","Blue","Red",
                    "Gold","Blue","Red",
                    "Gold","Blue","Red"
                 ];
                var noteStemSidePertchik = [+1,-1, +1, -1, +1, -1, +1, -1, +1, -1, +1, -1];
                var noteStemSideSoriano  = [-1, +1, -1, +1, -1, +1, -1, +1, -1, +1, -1, +1];
                var noteColorSoriano = [
                    "Ivory","MediumBlue","LightSkyBlue",
                    "Ivory","MediumBlue","LightSkyBlue",
                    "Ivory","MediumBlue","LightSkyBlue",
                    "Ivory","MediumBlue","LightSkyBlue"
                ];  //per C..B = midi mod 12
                var noteColorTransBW = [
                    "Ivory","LightGray","Black",
                    "Ivory","LightGray","Black",
                    "Ivory","LightGray","Black",
                    "Ivory","LightGray","Black"
                ];  //per C..B = midi mod 12

                var noteColorTrad = [
                    "Ivory","Black","Ivory","Black","Ivory",
                    "Ivory","Black","Ivory","Black","Ivory","Black","Ivory"
                ];  //per C..B = midi mod 12

                 // noteTriColor[Hollow,Solid,Cross]: white,black,gray
                 // noteTriColor = noteColorDTD;
                // DTD ChromaTonnetz2  : Staff: D F# Bb  Colors: Red Gold Blue
                var noteColorCT2 = [
                    "Red","Goldenrod","Blue",
                    "Red","Goldenrod","Blue",
                    "Red","Goldenrod","Blue",
                    "Red","Goldenrod","Blue"
                ];  //per C..B = midi mod 12
                var staffLineStyleCT2   = [,,"-",,,, "|",,,, "|",]; // C E Ab
                var staffLineWidthCT2 = [,,2,,,, 2,,,, 2,]; //double-width
                var staffLineColorCT2BW = [,,"White",,,,"Black",,,,"Black",];
                var staffLineColorCT2 = [,,"Yellow",,,,"Blue",,,,"Red",];
                var staffLineColorDTD = ["Gold",,,,"Blue",,,,"Red",,,];

//////////////////////////////////////////////////////////////////////////////
                //MIDI SONG DATA
                midiTkpQN = 960;
                midiTsigNN= 4;
                midiTsigDD= 4;

                // SONG DATA
                songNumQuanta   = 8*4; //measures * note pos/measure
                songNumNotes    = 48;   // actual count of note onset-times
                staffNoteLmidi  = 41;     // ; midi # of leftmost staff posn staffX0px
                staffNoteRmidi  = 83;     // ; midi # of rightmost staff posn

                var colNotes    =8;

                // GRAPHICS ELEMENT SIZE DATA
                // 4staff x 16note landsca[e: 6,17,2.8
                noteXSpacing    = 6;    //pixels; delta shift of successive chromatic notes
                noteSize        = 2.5*noteXSpacing; //width=height of notehead px; < 3 * XSpacing
                noteYSpacing    = 3 * noteSize; // >2.8 : stem - to - stem pixel distance of quantum time
                noteYHalfSpacing    = noteYSpacing / 2;  //half distance between notes for placing bar
                stemSize        = 3 * noteSize; //length of step px
                var countSize   = 1 * noteXSpacing;
                noteTextFont =  noteSize + "px Arial";
                noteCountFont=  1.5 * noteSize + "px Courier New"; // monospace

                //LAYOUT
                pageXpx= countSize + stemSize + 2 * noteXSpacing;  // start pixel
                pageYpx= 1 * noteYSpacing;  // start pixel
                staffXWidth = (staffNoteRmidi - staffNoteLmidi + 4) * noteXSpacing;
                colDXpx = staffXWidth + stemSize + countSize ;
                staffCountWidthPx   = 6 * noteXSpacing;

                //SCALE DATA

                noteAngle   = noteAngleC;
                noteStemDir = noteStemDirRhLh;
                noteColor   = noteColorCT2;
                noteStemSide = noteStemSidePertchik; //per  C..B midi mod 12

                // STAFF DATA

                staffLineWidth = staffLineWidthCT2;
                staffLineStyle = staffLineStyleCT2;
                staffLineColor = staffLineColorCT2BW;

                // PAGE LAYOUT

                var startTk = 184320;      //1st note of song (- anacrusus ticks)
                var numPos = songNumQuanta;
                staffY0tk = 0;
                staffTkPPos  = midiTkpQN / 2;   //ticks per position
                staffSegPos = 4*4;          // measures/segment * quanta/measure)



                var staffColTks         = staffMBarDeltaTk * 4;
                var staffPageySpacingPx = pageYpx + 10 * noteYSpacing;

                // STAFF SEGMENT
                staffSegNextTk  = startTk;
                staffNextCol    = 0;      //initial/next column number, 0-origin
                staffMaxCols    = 6;      // cols per page
                staffNextPage   = 0;      //initial/next page number, 0-origin

                // BARS
                staffMBarNextTk     = startTk;
                staffMBarDeltaTk    = midiTkpQN * 2;  //  qn/m *   tpqn

                // COUNTS
                counts16 =["1","e","&","a","2","e","&","a","3","e","&","a","4","e","&","a"];

                countNextTk     = startTk;    //first/next tick for count
                countDeltaTk    = midiTkpQN * 1;     //ticks between count legend
                countNextI      = 0;     //start/next index for count
                // adjust for anacrusis
                countDeltaI     = 4;     //incr of count index per legend as # of 1/16
                // adjust for ruler resolution
                countWrap = 4*2;         // wraparound count

                //function staffSeg(x0px, y0px, y0tk, qtk, numQ)
                //function bar(m, n, d, barType)

                function songMIDI() {
                    //var ytk =songTk(0,6,8);

                     // // // alert("songMIDI: pageXpx="+pageXpx+",pageYpx="+pageYpx);


                    var songTitle= "Molineux Jr 51   The Passing Train" ;
                    var para = document.getElementById('songTitle');
                    para.textContent=songTitle;
                    shapeTranspose= 12-0;//   //from MIDI to solfeddge C
                    pitchTranspose= 0; // from MIDI key to Score key:

                    staffAutoOn=true;

                    /**
                     * Created by josephaustin on 10/1/15.
                     */


                    midiCSV(0,1,184320,"Time_signature",2,2,24,8); //,-1,-1,9,,
//,51,,,,,,,,,,,,


                    midiCSV(0,3,184320,"Note_on_c",3,48,80); //,1,2,1172,,
                    midiCSV(0,3,184320,"Note_on_c",3,52,80); //,1,2,1173,,
                    midiCSV(0,2,184320,"Note_on_c",2,72,80); //,1,3,248,,
                    midiCSV(0,3,185280,"Note_off_c",3,52,0); //,0,2,1174,,
                    midiCSV(0,3,185280,"Note_off_c",3,48,0); //,0,2,1175,,
                    midiCSV(0,2,185280,"Note_off_c",2,72,0); //,0,3,249,,
                    midiCSV(0,3,185280,"Note_on_c",3,48,80); //,1,2,1176,,
                    midiCSV(0,3,185280,"Note_on_c",3,52,80); //,1,2,1177,,
                    midiCSV(0,2,185280,"Note_on_c",2,72,80); //,1,3,250,,
                    midiCSV(0,3,186240,"Note_off_c",3,52,0); //,0,2,1178,,
                    midiCSV(0,3,186240,"Note_off_c",3,48,0); //,0,2,1179,,
                    midiCSV(0,2,186240,"Note_off_c",2,72,0); //,0,3,251,,
                    midiCSV(0,3,186240,"Note_on_c",3,52,80); //,1,2,1180,,
                    midiCSV(0,3,186240,"Note_on_c",3,48,80); //,1,2,1181,,
                    midiCSV(0,2,186240,"Note_on_c",2,72,80); //,1,3,252,,
                    midiCSV(0,3,188160,"Note_off_c",3,48,0); //,0,2,1182,,
                    midiCSV(0,3,188160,"Note_off_c",3,52,0); //,0,2,1183,,
                    midiCSV(0,2,188160,"Note_off_c",2,72,0); //,0,3,253,,
                    midiCSV(0,3,188160,"Note_on_c",3,55,80); //,1,2,1184,,
                    midiCSV(0,3,188160,"Note_on_c",3,47,80); //,1,2,1185,,
                    midiCSV(0,2,188160,"Note_on_c",2,67,80); //,1,3,254,,
                    midiCSV(0,2,188640,"Note_off_c",2,67,0); //,0,3,255,,
                    midiCSV(0,2,188640,"Note_on_c",2,69,80); //,1,3,256,,
                    midiCSV(0,3,189120,"Note_off_c",3,47,0); //,0,2,1186,,
                    midiCSV(0,3,189120,"Note_off_c",3,55,0); //,0,2,1187,,
                    midiCSV(0,2,189120,"Note_off_c",2,69,0); //,0,3,257,,
                    midiCSV(0,3,189120,"Note_on_c",3,47,80); //,1,2,1188,,
                    midiCSV(0,3,189120,"Note_on_c",3,55,80); //,1,2,1189,,
                    midiCSV(0,2,189120,"Note_on_c",2,67,80); //,1,3,258,,
                    midiCSV(0,2,189600,"Note_off_c",2,67,0); //,0,3,259,,
                    midiCSV(0,2,189600,"Note_on_c",2,65,80); //,1,3,260,,
                    midiCSV(0,3,190080,"Note_off_c",3,55,0); //,0,2,1190,,
                    midiCSV(0,3,190080,"Note_off_c",3,47,0); //,0,2,1191,,
                    midiCSV(0,2,190080,"Note_off_c",2,65,0); //,0,3,261,,
                    midiCSV(0,3,190080,"Note_on_c",3,48,80); //,1,2,1192,,
                    midiCSV(0,3,190080,"Note_on_c",3,52,80); //,1,2,1193,,
                    midiCSV(0,2,190080,"Note_on_c",2,64,80); //,1,3,262,,
                    midiCSV(0,2,190560,"Note_off_c",2,64,0); //,0,3,263,,
                    midiCSV(0,2,190560,"Note_on_c",2,62,80); //,1,3,264,,
                    midiCSV(0,3,191040,"Note_off_c",3,52,0); //,0,2,1194,,
                    midiCSV(0,3,191040,"Note_off_c",3,48,0); //,0,2,1195,,
                    midiCSV(0,2,191040,"Note_off_c",2,62,0); //,0,3,265,,
                    midiCSV(0,3,191040,"Note_on_c",3,48,80); //,1,2,1196,,
                    midiCSV(0,3,191040,"Note_on_c",3,52,80); //,1,2,1197,,
                    midiCSV(0,2,191040,"Note_on_c",2,60,80); //,1,3,266,,
                    midiCSV(0,3,192000,"Note_off_c",3,52,0); //,0,2,1198,,
                    midiCSV(0,3,192000,"Note_off_c",3,48,0); //,0,2,1199,,
                    midiCSV(0,2,192000,"Note_off_c",2,60,0); //,0,3,267,,
                    midiCSV(0,3,192000,"Note_on_c",3,48,80); //,1,2,1200,,
                    midiCSV(0,3,192000,"Note_on_c",3,52,80); //,1,2,1201,,
                    midiCSV(0,2,192000,"Note_on_c",2,72,80); //,1,3,268,,
                    midiCSV(0,3,192960,"Note_off_c",3,52,0); //,0,2,1202,,
                    midiCSV(0,3,192960,"Note_off_c",3,48,0); //,0,2,1203,,
                    midiCSV(0,2,192960,"Note_off_c",2,72,0); //,0,3,269,,
                    midiCSV(0,3,192960,"Note_on_c",3,52,80); //,1,2,1204,,
                    midiCSV(0,3,192960,"Note_on_c",3,48,80); //,1,2,1205,,
                    midiCSV(0,2,192960,"Note_on_c",2,72,80); //,1,3,270,,
                    midiCSV(0,3,193920,"Note_off_c",3,52,0); //,0,2,1206,,
                    midiCSV(0,3,193920,"Note_off_c",3,48,0); //,0,2,1207,,
                    midiCSV(0,2,193920,"Note_off_c",2,72,0); //,0,3,271,,
                    midiCSV(0,3,193920,"Note_on_c",3,52,80); //,1,2,1208,,
                    midiCSV(0,3,193920,"Note_on_c",3,48,80); //,1,2,1209,,
                    midiCSV(0,2,193920,"Note_on_c",2,72,80); //,1,3,272,,
                    midiCSV(0,3,195840,"Note_off_c",3,48,0); //,0,2,1210,,
                    midiCSV(0,3,195840,"Note_off_c",3,52,0); //,0,2,1211,,
                    midiCSV(0,2,195840,"Note_off_c",2,72,0); //,0,3,273,,
                    midiCSV(0,3,195840,"Note_on_c",3,55,80); //,1,2,1212,,
                    midiCSV(0,3,195840,"Note_on_c",3,50,80); //,1,2,1213,,
                    midiCSV(0,2,195840,"Note_on_c",2,71,80); //,1,3,274,,
                    midiCSV(0,2,196320,"Note_off_c",2,71,0); //,0,3,275,,
                    midiCSV(0,2,196320,"Note_on_c",2,67,80); //,1,3,276,,
                    midiCSV(0,3,196800,"Note_off_c",3,50,0); //,0,2,1214,,
                    midiCSV(0,3,196800,"Note_off_c",3,55,0); //,0,2,1215,,
                    midiCSV(0,2,196800,"Note_off_c",2,67,0); //,0,3,277,,
                    midiCSV(0,3,196800,"Note_on_c",3,50,80); //,1,2,1216,,
                    midiCSV(0,3,196800,"Note_on_c",3,60,80); //,1,2,1217,,
                    midiCSV(0,2,196800,"Note_on_c",2,69,80); //,1,3,278,,
                    midiCSV(0,2,197280,"Note_off_c",2,69,0); //,0,3,279,,
                    midiCSV(0,2,197280,"Note_on_c",2,66,80); //,1,3,280,,
                    midiCSV(0,3,197760,"Note_off_c",3,60,0); //,0,2,1218,,
                    midiCSV(0,3,197760,"Note_off_c",3,50,0); //,0,2,1219,,
                    midiCSV(0,2,197760,"Note_off_c",2,66,0); //,0,3,281,,
                    midiCSV(0,3,197760,"Note_on_c",3,55,80); //,1,2,1220,,
                    midiCSV(0,3,197760,"Note_on_c",3,59,80); //,1,2,1221,,
                    midiCSV(0,2,197760,"Note_on_c",2,67,80); //,1,3,282,,
                    midiCSV(0,3,199680,"Note_off_c",3,59,0); //,0,2,1222,,
                    midiCSV(0,3,199680,"Note_off_c",3,55,0); //,0,2,1223,,
                    midiCSV(0,2,199680,"Note_off_c",2,67,0); //,0,3,283,,
                    midiCSV(0,3,199680,"Note_on_c",3,55,80); //,1,2,1224,,
                    midiCSV(0,2,199680,"Note_on_c",2,67,80); //,1,3,284,,
                    midiCSV(0,2,200160,"Note_off_c",2,67,0); //,0,3,285,,
                    midiCSV(0,2,200160,"Note_on_c",2,69,80); //,1,3,286,,
                    midiCSV(0,3,200640,"Note_off_c",3,55,0); //,0,2,1225,,
                    midiCSV(0,2,200640,"Note_off_c",2,69,0); //,0,3,287,,
                    midiCSV(0,3,200640,"Note_on_c",3,53,80); //,1,2,1226,,
                    midiCSV(0,2,200640,"Note_on_c",2,67,80); //,1,3,288,,
                    midiCSV(0,2,201120,"Note_off_c",2,67,0); //,0,3,289,,
                    midiCSV(0,2,201120,"Note_on_c",2,69,80); //,1,3,290,,
                    midiCSV(0,3,201600,"Note_off_c",3,53,0); //,0,2,1227,,
                    midiCSV(0,2,201600,"Note_off_c",2,69,0); //,0,3,291,,
                    midiCSV(0,3,201600,"Note_on_c",3,52,80); //,1,2,1228,,
                    midiCSV(0,2,201600,"Note_on_c",2,67,80); //,1,3,292,,
                    midiCSV(0,2,202560,"Note_off_c",2,67,0); //,0,3,293,,
                    midiCSV(0,2,202560,"Note_on_c",2,72,80); //,1,3,294,,
                    midiCSV(0,3,203520,"Note_off_c",3,52,0); //,0,2,1229,,
                    midiCSV(0,2,203520,"Note_off_c",2,72,0); //,0,3,295,,
                    midiCSV(0,3,203520,"Note_on_c",3,53,80); //,1,2,1230,,
                    midiCSV(0,3,203520,"Note_on_c",3,55,80); //,1,2,1231,,
                    midiCSV(0,2,203520,"Note_on_c",2,71,80); //,1,3,296,,
                    midiCSV(0,2,204480,"Note_off_c",2,71,0); //,0,3,297,,
                    midiCSV(0,2,204480,"Note_on_c",2,67,80); //,1,3,298,,
                    midiCSV(0,3,205440,"Note_off_c",3,53,0); //,0,2,1232,,
                    midiCSV(0,3,205440,"Note_off_c",3,55,0); //,0,2,1233,,
                    midiCSV(0,2,205440,"Note_off_c",2,67,0); //,0,3,299,,
                    midiCSV(0,3,205440,"Note_on_c",3,52,80); //,1,2,1234,,
                    midiCSV(0,3,205440,"Note_on_c",3,55,80); //,1,2,1235,,
                    midiCSV(0,2,205440,"Note_on_c",2,72,80); //,1,3,300,,
                    midiCSV(0,2,206400,"Note_off_c",2,72,0); //,0,3,301,,
                    midiCSV(0,2,206400,"Note_on_c",2,67,80); //,1,3,302,,
                    midiCSV(0,3,207360,"Note_off_c",3,52,0); //,0,2,1236,,
                    midiCSV(0,3,207360,"Note_off_c",3,55,0); //,0,2,1237,,
                    midiCSV(0,2,207360,"Note_off_c",2,67,0); //,0,3,303,,
                    midiCSV(0,3,207360,"Note_on_c",3,55,80); //,1,2,1238,,
                    midiCSV(0,2,207360,"Note_on_c",2,67,80); //,1,3,304,,
                    midiCSV(0,2,207840,"Note_off_c",2,67,0); //,0,3,305,,
                    midiCSV(0,2,207840,"Note_on_c",2,69,80); //,1,3,306,,
                    midiCSV(0,3,208320,"Note_off_c",3,55,0); //,0,2,1239,,
                    midiCSV(0,2,208320,"Note_off_c",2,69,0); //,0,3,307,,
                    midiCSV(0,3,208320,"Note_on_c",3,53,80); //,1,2,1240,,
                    midiCSV(0,2,208320,"Note_on_c",2,67,80); //,1,3,308,,
                    midiCSV(0,2,208800,"Note_off_c",2,67,0); //,0,3,309,,
                    midiCSV(0,2,208800,"Note_on_c",2,69,80); //,1,3,310,,
                    midiCSV(0,3,209280,"Note_off_c",3,53,0); //,0,2,1241,,
                    midiCSV(0,2,209280,"Note_off_c",2,69,0); //,0,3,311,,
                    midiCSV(0,3,209280,"Note_on_c",3,52,80); //,1,2,1242,,
                    midiCSV(0,2,209280,"Note_on_c",2,67,80); //,1,3,312,,
                    midiCSV(0,2,209760,"Note_off_c",2,67,0); //,0,3,313,,
                    midiCSV(0,2,209760,"Note_on_c",2,72,80); //,1,3,314,,
                    midiCSV(0,3,210240,"Note_off_c",3,52,0); //,0,2,1243,,
                    midiCSV(0,2,210240,"Note_off_c",2,72,0); //,0,3,315,,
                    midiCSV(0,3,210240,"Note_on_c",3,53,80); //,1,2,1244,,
                    midiCSV(0,2,210240,"Note_on_c",2,71,80); //,1,3,316,,
                    midiCSV(0,2,210720,"Note_off_c",2,71,0); //,0,3,317,,
                    midiCSV(0,2,210720,"Note_on_c",2,69,80); //,1,3,318,,
                    midiCSV(0,3,211200,"Note_off_c",3,53,0); //,0,2,1245,,
                    midiCSV(0,2,211200,"Note_off_c",2,69,0); //,0,3,319,,
                    midiCSV(0,3,211200,"Note_on_c",3,55,80); //,1,2,1246,,
                    midiCSV(0,2,211200,"Note_on_c",2,67,80); //,1,3,320,,
                    midiCSV(0,2,211680,"Note_off_c",2,67,0); //,0,3,321,,
                    midiCSV(0,2,211680,"Note_on_c",2,65,80); //,1,3,322,,
                    midiCSV(0,3,212160,"Note_off_c",3,55,0); //,0,2,1247,,
                    midiCSV(0,2,212160,"Note_off_c",2,65,0); //,0,3,323,,
                    midiCSV(0,3,212160,"Note_on_c",3,55,80); //,1,2,1248,,
                    midiCSV(0,2,212160,"Note_on_c",2,64,80); //,1,3,324,,
                    midiCSV(0,2,212640,"Note_off_c",2,64,0); //,0,3,325,,
                    midiCSV(0,2,212640,"Note_on_c",2,62,80); //,1,3,326,,
                    midiCSV(0,3,213120,"Note_off_c",3,55,0); //,0,2,1249,,
                    midiCSV(0,2,213120,"Note_off_c",2,62,0); //,0,3,327,,
                    midiCSV(0,3,213120,"Note_on_c",3,52,80); //,1,2,1250,,
                    midiCSV(0,3,213120,"Note_on_c",3,48,80); //,1,2,1251,,
                    midiCSV(0,2,213120,"Note_on_c",2,60,80); //,1,3,328,,
                    midiCSV(0,3,215040,"Note_off_c",3,52,0); //,0,2,1252,,
                    midiCSV(0,3,215040,"Note_off_c",3,48,0); //,0,2,1253,,
                    midiCSV(0,2,215040,"Note_off_c",2,60,0); //,0,3,329,,

                     }
                 /////// // // alert("Call:songMIDI");
                songMIDI();
            }//if (canvas.getContext)
        }//function draw()
    </script>
</head>


<body onload="draw();">
<p id="songTitle" style="font-size: 150%; margin: 0px;
   padding: 0px;">Hymn</p>
<!-- portrait w > 1200w x h > 1500
<canvas id="canvas" width="1200" height="1350"></canvas>-->

<!-- landscape w >1500 x  1100 > high;  >1050 w header-->
<canvas id="canvas" width="1500" height="1000"></canvas>


<!-- <p>after</p> --<

<!-- 28.5 x 17.8 cm ~114 dpi -->


<p>ver160204;  Staff Lines: | - | = Bb D F# ;   Notes:  ^ v ^ / > < > < / ^ do re mi / fa so la ti / do
<!--
<p style="font-size:x-small">CREDITS:
    This "Tonnetz2" music notation is a synthesis of many ideas;
    refer to musicnotation.org for background on these ideas and alternative music notations in general.
    <br/>Jjavascrpt scoring software by Joseph Austin, DrTechDaddy.com
    <br/>Chromatone isomorphic keyboard: http://chromatone.jp [Japanese language site]
    <br/>Tri-color keyboard concept patented by Roy Pertchik US6566593 US20020029682;
    <br/>ChromaTonnetz 3 x 4 shape-notes by Joseph Austin, DrTechDaddy.com
    <br/>Ivory/blue/navy coloring for Chromatone suggested by O.E. Soriano
    <br/>Kalavarskribo vertical staff and piano-layout style notation developed by Cornelius Pot: http://www.klavarskribo.nl/en/history
    <br/>Klavar 6-6 split for Janko suggested by Antoon Dekker;
    <br/>Clairnote C-E-G# staff developed by Paul Morris;
-->
</p>
</body>
</html>
